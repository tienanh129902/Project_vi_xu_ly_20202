<!DOCTYPE HTML>
<html>

<head>
  <title>ESP32 Web Server</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
    integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
</head>
<h2>ESP32 DHT11 Server</h2>
<div class="graph-container">
  <iframe width="450" height="260" style="border: 1px solid #cccccc;"
    src="https://thingspeak.com/channels/1476218/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&title=Project+2021&type=line&xaxis=Timestamp&yaxis=Temp"></iframe>
  <iframe width="450" height="260" style="border: 1px solid #cccccc;"
    src="https://thingspeak.com/channels/1476218/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&title=Project+2021&type=line&xaxis=Timestamp&yaxis=Humidity"></iframe>
</div>
<style>
  html {
    text-align: center;
  }

  h2 {
    font-size: 3.0rem;
  }

  p {
    font-size: 3.0rem;
  }

  .units {
    font-size: 1.2rem;
  }

  .dht-labels {
    font-size: 1.5rem;
    vertical-align: middle;
    padding-bottom: 15px;
  }
</style>

<body>
  <p>
    <i class="fas fa-thermometer-half" style="color:#059e8a;"></i>
    <span class="dht-labels">Temperature</span>
    <span id="temperature">%TEMPERATURE%</span>
    <sup class="units">&deg;C</sup>
  </p>
  <p>
    <i class="fas fa-tint" style="color:#00add6;"></i>
    <span class="dht-labels">Humidity</span>
    <span id="humidity">%HUMIDITY%</span>
    <sup class="units">%</sup>
  </p>

  <div class="form-container">
    <form action="/get" target="hidden-form">
      Limit Temperature: <input type="text" name="inputTemp">
      <input type="submit" value="Submit" onclick="submitMessage()">
    </form><br>
    <form action="/get" target="hidden-form">
      Limit Humidity: <input type="text " name="inputHumid">
      <input type="submit" value="Submit" onclick="submitMessage()">
    </form><br>
    <form action="/get" target="hidden-form">
      Offset Temperature: <input type="text " name="offsetTemp">
      <input type="submit" value="Submit" onclick="submitMessage()">
    </form><br>
    <form action="/get" target="hidden-form">
      Offset Humidity: <input type="text " name="offsetHumid">
      <input type="submit" value="Submit" onclick="submitMessage()">
    </form><br>
    <iframe style="display:none" name="hidden-form"></iframe><br>
  </div>

  <script>
    function submitMessage() {
      alert("Saved value to ESP SPI Flash File System");
      setTimeout(function () { document.location.reload(false); }, 500);
    }
    setInterval(function () {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          document.getElementById("temperature").innerHTML = this.responseText;
        }
      };
      xhttp.open("GET", "/temperature", true);
      xhttp.send();
    }, 10000);

    setInterval(function () {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          document.getElementById("humidity").innerHTML = this.responseText;
        }
      };
      xhttp.open("GET", "/humidity", true);
      xhttp.send();
    }, 10000);
  </script>
</body>


</html>